openapi: 3.0.0
info:
  title: MarketDataAPI
  version: '1.0'
  description: API for financial market data, instrument details, and legal entity
    information
servers:
- url: http://127.0.0.1:5000/api/v1
  description: Development server
paths:
  /instruments/:
    get:
      summary: Retrieves a paginated list of instruments
      description: Retrieves a paginated list of instruments
      operationId: get_instrument_list
      tags:
      - instruments
      parameters:
      - name: type
        in: query
        description: Filter by instrument type (e.g., "equity", "debt", "future")
        required: false
        schema:
          type: string
      - name: currency
        in: query
        description: Filter by currency code
        required: false
        schema:
          type: string
      - name: page
        in: query
        description: 'Page number for paginated results (default: 1)'
        required: false
        schema:
          type: string
      - name: per_page
        in: query
        description: 'Number of records per page (default: 20, max: 100)'
        required: false
        schema:
          type: string
      - name: limit
        in: query
        description: Maximum number of records to return
        required: false
        schema:
          type: string
      - name: offset
        in: query
        description: Number of records to skip
        required: false
        schema:
          type: string
      - name: X-Fields
        in: header
        description: An optional fields mask
        required: false
        schema:
          type: string
          format: mask
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstrumentListResponse'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
  /instruments/{isin}:
    get:
      summary: Retrieves detailed information about a specific instrument by its ISIN
      description: Retrieves detailed information about a specific instrument by its
        ISIN
      operationId: get_instrument_detail
      tags:
      - instruments
      parameters: []
      responses:
        '200':
          description: Success
        '404':
          description: Instrument not found
        '401':
          description: Unauthorized
  /legal-entities/:
    get:
      summary: Retrieves a paginated list of legal entities
      description: Retrieves a paginated list of legal entities
      operationId: get_legal_entity_list
      tags:
      - legal-entities
      parameters:
      - name: status
        in: query
        description: Filter by entity status (e.g., "ACTIVE", "INACTIVE", "PENDING")
        required: false
        schema:
          type: string
      - name: jurisdiction
        in: query
        description: Filter by jurisdiction code (ISO 3166-1)
        required: false
        schema:
          type: string
      - name: page
        in: query
        description: 'Page number for paginated results (default: 1)'
        required: false
        schema:
          type: string
      - name: per_page
        in: query
        description: 'Number of records per page (default: 20, max: 100)'
        required: false
        schema:
          type: string
      - name: limit
        in: query
        description: Maximum number of records to return
        required: false
        schema:
          type: string
      - name: offset
        in: query
        description: Number of records to skip
        required: false
        schema:
          type: string
      - name: X-Fields
        in: header
        description: An optional fields mask
        required: false
        schema:
          type: string
          format: mask
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LegalEntityListResponse'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
  /legal-entities/{lei}:
    get:
      summary: Retrieves detailed information about a specific legal entity by its
        LEI
      description: Retrieves detailed information about a specific legal entity by
        its LEI
      operationId: get_legal_entity_detail
      tags:
      - legal-entities
      parameters: []
      responses:
        '200':
          description: Success
        '404':
          description: Legal entity not found
        '401':
          description: Unauthorized
  /relationships/{lei}:
    get:
      summary: Retrieves all relationships for a specific legal entity
      description: Retrieves all relationships for a specific legal entity
      operationId: get_entity_relationships
      tags:
      - relationships
      parameters:
      - name: relationship_type
        in: query
        description: Filter by relationship type ("DIRECT", "ULTIMATE")
        required: false
        schema:
          type: string
      - name: relationship_status
        in: query
        description: Filter by relationship status ("ACTIVE", "INACTIVE")
        required: false
        schema:
          type: string
      - name: direction
        in: query
        description: Filter by relationship direction ("PARENT", "CHILD")
        required: false
        schema:
          type: string
      - name: page
        in: query
        description: 'Page number for paginated results (default: 1)'
        required: false
        schema:
          type: string
      - name: per_page
        in: query
        description: 'Number of records per page (default: 20, max: 100)'
        required: false
        schema:
          type: string
      responses:
        '200':
          description: Success
        '404':
          description: Legal entity not found
        '401':
          description: Unauthorized
  /schemas/:
    get:
      summary: Retrieves a list of all available schemas
      description: Retrieves a list of all available schemas
      operationId: get_schema_list
      tags:
      - schemas
      parameters:
      - name: type
        in: query
        description: Filter by schema type ("instrument", "legal_entity", "relationship")
        required: false
        schema:
          type: string
      - name: status
        in: query
        description: Filter by schema status ("active", "draft", "deprecated")
        required: false
        schema:
          type: string
      - name: page
        in: query
        description: 'Page number for paginated results (default: 1)'
        required: false
        schema:
          type: string
      - name: per_page
        in: query
        description: 'Number of records per page (default: 20, max: 100)'
        required: false
        schema:
          type: string
      - name: X-Fields
        in: header
        description: An optional fields mask
        required: false
        schema:
          type: string
          format: mask
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaListResponse'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
  /transparency:
    get:
      summary: Get all transparency calculations with optional filtering
      description: ''
      operationId: list_transparency_calculations
      tags:
      - transparency
      parameters:
      - name: per_page
        in: query
        description: Items per page
        required: false
        schema:
          type: integer
      - name: page
        in: query
        description: Page number
        required: false
        schema:
          type: integer
      - name: isin
        in: query
        description: Filter by ISIN
        required: false
        schema:
          type: string
      - name: instrument_type
        in: query
        description: Filter by instrument type
        required: false
        schema:
          type: string
      - name: calculation_type
        in: query
        description: Filter by calculation type
        required: false
        schema:
          type: string
      - name: X-Fields
        in: header
        description: An optional fields mask
        required: false
        schema:
          type: string
          format: mask
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransparencyListResponse'
    post:
      summary: Create a new transparency calculation
      description: ''
      operationId: create_transparency_calculation
      tags:
      - transparency
      parameters:
      - name: payload
        in: body
        description: ''
        required: true
        schema:
          type: string
      responses:
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '201':
          description: Transparency calculation created
  /transparency/batch:
    post:
      summary: Batch source transparency calculations from FITRS data
      description: ''
      operationId: batch_source_transparency
      tags:
      - transparency
      parameters:
      - name: payload
        in: body
        description: ''
        required: true
        schema:
          type: string
      responses:
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '201':
          description: Transparency calculations sourced from FITRS
  /transparency/batch-create:
    post:
      summary: Batch create transparency calculations from provided data
      description: ''
      operationId: batch_create_transparency
      tags:
      - transparency
      parameters:
      - name: payload
        in: body
        description: ''
        required: true
        schema:
          type: string
      responses:
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '201':
          description: Transparency calculations created
  /transparency/isin/{isin}:
    get:
      summary: Get transparency calculations for a specific ISIN
      description: ''
      operationId: get_transparency_by_isin
      tags:
      - transparency
      parameters:
      - name: ensure_instrument
        in: query
        description: Ensure instrument exists before creating transparency data
        required: false
        schema:
          type: boolean
      - name: calculation_type
        in: query
        description: Calculation type to get/create
        required: false
        schema:
          type: string
      - name: X-Fields
        in: header
        description: An optional fields mask
        required: false
        schema:
          type: string
          format: mask
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransparencyListResponse'
  /transparency/{transparency_id}:
    get:
      summary: Get transparency calculation by ID
      description: ''
      operationId: get_transparency_calculation
      tags:
      - transparency
      parameters:
      - name: X-Fields
        in: header
        description: An optional fields mask
        required: false
        schema:
          type: string
          format: mask
      responses:
        '404':
          description: Transparency calculation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransparencyDetailed'
    delete:
      summary: Delete a transparency calculation
      description: ''
      operationId: delete_transparency_calculation
      tags:
      - transparency
      parameters: []
      responses:
        '404':
          description: Transparency calculation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '200':
          description: Transparency calculation deleted
    put:
      summary: Update an existing transparency calculation
      description: ''
      operationId: update_transparency_calculation
      tags:
      - transparency
      parameters:
      - name: payload
        in: body
        description: ''
        required: true
        schema:
          type: string
      responses:
        '404':
          description: Transparency calculation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '200':
          description: Transparency calculation updated
components:
  schemas:
    InstrumentListResponse:
      type: object
      properties:
        status:
          type: string
          description: Response status
          example: success
          enum:
          - success
        data:
          type: array
          items:
            $ref: '#/components/schemas/InstrumentBase'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
      required:
      - status
    InstrumentBase:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier
        isin:
          type: string
          description: International Securities Identification Number
        type:
          type: string
          description: Instrument type (equity, debt, future, etc.)
        full_name:
          type: string
          description: Full name of the instrument
        symbol:
          type: string
          description: Symbol or short name
        currency:
          type: string
          description: Currency code (ISO 4217)
        cfi_code:
          type: string
          description: CFI code
      required:
      - full_name
      - id
      - isin
    PaginationMeta:
      type: object
      properties:
        page:
          type: integer
          description: Current page number
        per_page:
          type: integer
          description: Items per page
        total:
          type: integer
          description: Total number of items
    LegalEntityListResponse:
      type: object
      properties:
        status:
          type: string
          description: Response status
          example: success
          enum:
          - success
        data:
          type: array
          items:
            $ref: '#/components/schemas/LegalEntityBase'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
      required:
      - status
    LegalEntityBase:
      type: object
      properties:
        lei:
          type: string
          description: Legal Entity Identifier (20 characters)
        name:
          type: string
          description: Legal name of the entity
        jurisdiction:
          type: string
          description: Jurisdiction code (ISO 3166-1)
        legal_form:
          type: string
          description: Legal form of the entity
        status:
          type: string
          description: Current status (Active, Inactive, Pending)
      required:
      - lei
      - name
    SchemaListResponse:
      type: object
      properties:
        status:
          type: string
          description: Response status
          example: success
          enum:
          - success
        data:
          type: array
          items:
            $ref: '#/components/schemas/SchemaBase'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
      required:
      - status
    SchemaBase:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the schema
        name:
          type: string
          description: Display name for the schema
        description:
          type: string
          description: Description of the schema and its purpose
        type:
          type: string
          description: Type of the schema (instrument, legal_entity, relationship)
        status:
          type: string
          description: Status of the schema (active, draft, deprecated)
        version:
          type: string
          description: Version of the schema
        created_at:
          type: string
          description: Creation date
          format: date-time
        updated_at:
          type: string
          description: Last update date
          format: date-time
      required:
      - id
      - name
      - type
    TransparencyCreateRequest:
      type: object
      properties:
        ISIN:
          type: string
          description: International Securities Identification Number
        TechRcrdId:
          type: string
          description: Technical record identifier
        calculation_type:
          type: string
          description: Type of calculation
          example: EQUITY
          enum:
          - EQUITY
          - NON_EQUITY
        FrDt:
          type: string
          description: From date (YYYY-MM-DD)
        ToDt:
          type: string
          description: To date (YYYY-MM-DD)
        Lqdty:
          type: string
          description: Liquidity (true/false)
        TtlNbOfTxsExctd:
          type: integer
          description: Total number of transactions executed
        TtlVolOfTxsExctd:
          type: number
          description: Total volume of transactions executed
        Desc:
          type: string
          description: Description
        CritNm:
          type: string
          description: Criterion name
        CritVal:
          type: string
          description: Criterion value
      required:
      - ISIN
      - TechRcrdId
    TransparencyListResponse:
      type: object
      properties:
        status:
          type: string
          description: Response status
          example: success
          enum:
          - success
        data:
          type: array
          items:
            $ref: '#/components/schemas/TransparencyDetailed'
        meta:
          $ref: '#/components/schemas/PaginationMeta'
      required:
      - status
    TransparencyDetailed: {}
    TransparencyBase:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier
        isin:
          type: string
          description: International Securities Identification Number
        calculation_type:
          type: string
          description: Type of calculation
          example: EQUITY
          enum:
          - EQUITY
          - NON_EQUITY
        tech_record_id:
          type: string
          description: Technical record identifier
        from_date:
          type: string
          description: From date
          format: date-time
        to_date:
          type: string
          description: To date
          format: date-time
        liquidity:
          type: boolean
          description: Liquidity indicator
        total_transactions_executed:
          type: integer
          description: Total number of transactions executed
        total_volume_executed:
          type: number
          description: Total volume of transactions executed
        created_at:
          type: string
          description: Creation timestamp
          format: date-time
        updated_at:
          type: string
          description: Last update timestamp
          format: date-time
      required:
      - calculation_type
      - id
      - isin
    EquityTransparencyDetails:
      type: object
      properties:
        financial_instrument_classification:
          type: string
          description: Financial instrument classification
        methodology:
          type: string
          description: Methodology used
        average_daily_turnover:
          type: number
          description: Average daily turnover
        large_in_scale:
          type: number
          description: Large in scale threshold
        average_daily_number_of_transactions:
          type: number
          description: Average daily number of transactions
        average_transaction_value:
          type: number
          description: Average transaction value
        standard_market_size:
          type: number
          description: Standard market size
    DebtTransparencyDetails:
      type: object
      properties:
        description:
          type: string
          description: Description
        bond_type:
          type: string
          description: Bond type
        is_liquid:
          type: boolean
          description: Liquidity indicator
        pre_trade_large_in_scale_threshold:
          type: number
          description: Pre-trade large in scale threshold
        post_trade_large_in_scale_threshold:
          type: number
          description: Post-trade large in scale threshold
        criterion_name:
          type: string
          description: Criterion name
        criterion_value:
          type: string
          description: Criterion value
    FuturesTransparencyDetails:
      type: object
      properties:
        description:
          type: string
          description: Description
        underlying_isin:
          type: string
          description: Underlying instrument ISIN
        is_stock_dividend_future:
          type: boolean
          description: Stock dividend future indicator
        pre_trade_large_in_scale_threshold:
          type: number
          description: Pre-trade large in scale threshold
        post_trade_large_in_scale_threshold:
          type: number
          description: Post-trade large in scale threshold
        criterion_name:
          type: string
          description: Criterion name
        criterion_value:
          type: string
          description: Criterion value
    Error:
      type: object
      properties:
        status:
          type: string
          description: Error status
          example: error
          enum:
          - error
        error:
          $ref: '#/components/schemas/ErrorDetails'
      required:
      - status
    ErrorDetails:
      type: object
      properties:
        code:
          type: string
          description: Error code
        message:
          type: string
          description: Error message description
      required:
      - code
      - message
    BatchTransparencyRequest:
      type: object
      properties:
        calculation_type:
          type: string
          description: Type of calculation
          example: EQUITY
          enum:
          - EQUITY
          - NON_EQUITY
        isin_prefix:
          type: string
          description: ISIN prefix filter (e.g., 'NL' for Netherlands)
        limit:
          type: integer
          description: Maximum number of calculations to create
        cfi_type:
          type: string
          description: CFI type filter (D, F, E)
          example: D
          enum:
          - D
          - F
          - E
      required:
      - calculation_type
    BatchCreateTransparencyRequest:
      type: object
      properties:
        records:
          type: array
          description: List of transparency records to create
          items:
            $ref: '#/components/schemas/TransparencyCreateRequest'
      required:
      - records
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: Authorization
security:
- ApiKeyAuth: []
